(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{123:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){},217:function(e,t,n){e.exports=n(391)},300:function(e,t,n){},301:function(e,t,n){},303:function(e,t,n){},304:function(e,t,n){},305:function(e,t,n){},306:function(e,t,n){},307:function(e,t,n){},311:function(e,t){},313:function(e,t){},347:function(e,t){},348:function(e,t){},390:function(e,t,n){},391:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(24),o=n.n(i),c=n(5),s=n(6),l=n(8),u=n(7),p=n(9),d=n(65),m=n(21),h=n(404),f=n(415),v=n(414),E=n(397),g=n(208),b=n(42),y=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(E.a,null,r.a.createElement(b.LinkContainer,{to:"/login"},r.a.createElement(g.a,{variant:"outline-success"},"Log In")),r.a.createElement(b.LinkContainer,{to:"/register"},r.a.createElement(g.a,{variant:"outline-primary"},"Sign Up"))))}}]),t}(a.Component),O=n(412),S=n(398),j=n(399),C=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(O.a,{placement:this.props.placement?this.props.placement:"top",overlay:r.a.createElement(S.a,null,this.props.profile.first_name||this.props.profile.last_name?"".concat(this.props.profile.first_name," ").concat(this.props.profile.last_name):this.props.profile.username)},r.a.createElement(b.LinkContainer,{to:"/profile/".concat(this.props.profile.username)},r.a.createElement("span",{style:{zIndex:"999"}},r.a.createElement(j.a,{className:"mr-1",variant:this.props.variant,pill:!0},this.props.profile.username))))}}]),t}(a.Component),I=n(407),k=n(400),w=n(78),A=n.n(w),T=n(16),F=n.n(T),D="https://holpoint.ns0.it",R=D+"/api/",U=R+"profile/",_=R+"group/",x=R+"group_creator/",N=R+"idea/",M=R+"vote/",L=R+"unfriend/",z=R+"group_activity/",G=R+"activity_creator/",q=function(e,t){return{type:"ADD_ALERT",text:e,style:t}},P=function(e){return function(t){if(e.response)for(var n=0,a=Object.entries(e.response.data);n<a.length;n++){var r=a[n],i="",o=r[0].replace(/^\w/,(function(e){return e.toUpperCase()})),c=r[1];i+="Non_field_errors"!==o?"".concat(o,": ").concat(c,"\n"):"".concat(c,"\n"),t(q(i,"danger"))}else t(q(e.message,"danger"));return{type:"ERROR",error:e}}},B=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return function(e){return e({type:"GET_CURRENT_USER_START"}),F.a.get("https://holpoint.ns0.it/api/current_user",t).then((function(t){var n=t.data,a=n.id,r=n.username,i=n.first_name,o=n.last_name,c=n.email,s=n.profile;e(function(e,t,n,a,r,i){return{type:"GET_CURRENT_USER_SUCCESS",id:e,username:t,first_name:n,last_name:a,email:r,profile:i}}(a,r,i,o,c,s))})).catch((function(t){return e(function(e){return{type:"GET_CURRENT_USER_FAIL",error:e}}(t)),e(P(t)),t}))}},H=function(e){return{type:"ADD_FRIEND_TO_STORE",friend:e}},V=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return function(e){return F.a.get("https://holpoint.ns0.it/api/friendrequests",t).then((function(t){e({type:"GET_FRIEND_REQUESTS",payload:t.data})})).catch((function(t){e(P(t))}))}},Q=function(e,t,n,a){var r=localStorage.getItem("token"),i={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(r)}};return function(r){return F.a.put("".concat("https://holpoint.ns0.it/api/friendrequest/").concat(e,"/"),{sender:t,receiver:n,status:a},i).then((function(t){r(function(e){return{type:"PUT_FRIEND_REQUEST",requestId:e}}(e))})).catch((function(e){r(P(e))}))}},W=function(e){return{type:"AUTH_SUCCESS",token:e}},Y=function(e){return{type:"AUTH_FAIL",error:e}},J=function(e){return function(t){setTimeout((function(){X()}),1e3*e)}},K={headers:{"Content-Type":"application/json"}},X=function(){return function(e){e((localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),{type:"AUTH_LOGOUT"})),e({type:"GET_CURRENT_USER_LOGOUT"}),e({type:"CLEAR_FRIEND_REQUESTS"})}},$=n(14),Z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickLogout=function(e){e.preventDefault(),n.props.logout(),n.props.history.push("/")},n.onClickProfile=function(e){e.preventDefault();var t="/profile/".concat(n.props.currentUser.username);n.props.history.push(t)},n.dropdownItems=[{key:1,name:"Impostazioni",to:"/settings"}],n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,!this.props.currentUser.loading&&r.a.createElement(I.a,{as:E.a,alignRight:!0},r.a.createElement(g.a,{style:{backgroundColor:"var(--holpoint-yellow)"},variant:"warning",onClick:this.onClickProfile},r.a.createElement(k.a,{src:this.props.currentUser.profile.picture?this.props.currentUser.profile.picture:A.a,className:"profile-pic-small"}),"   "+this.props.currentUser.username),r.a.createElement(I.a.Toggle,{split:!0,variant:"warning",style:{backgroundColor:"var(--holpoint-yellow)"}}),r.a.createElement(I.a.Menu,null,this.dropdownItems.map((function(e){return r.a.createElement(b.LinkContainer,{to:e.to,key:e.key},r.a.createElement(I.a.Item,null,e.name))})),r.a.createElement(I.a.Divider,null),r.a.createElement(I.a.Item,null,r.a.createElement(g.a,{variant:"outline-danger",onClick:this.onClickLogout},"Log Out")))))}}]),t}(a.Component),ee=Object(d.o)(Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{logout:function(){return e(X())}}}))(Z)),te=(n(123),function(e){var t={fontFamily:"'Rancho', cursive",fontSize:e.fontSize,textAlign:"center",marginTop:"-20px",marginBottom:"-20px"};return r.a.createElement("div",{style:t},r.a.createElement("span",{style:{color:"var(--holpoint-blue)"}},"Hol"),r.a.createElement("span",{style:{color:"var(--holpoint-red)"}},"Point"))}),ne=n(84),ae=n.n(ne),re=n(410);n(162);function ie(e){return r.a.createElement(ae.a,{selected:e.selected,onChange:function(t){return e.onChange(t)},className:"form-control",locale:"it",minDate:e.minDate?e.minDate:null,dateFormat:"dd/MM/yyyy"})}function oe(e){return r.a.createElement(ae.a,{className:"form-control",selected:e.selected,onChange:function(t){return e.onChange(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,locale:"it",timeCaption:"Ora",dateFormat:"HH:mm"})}Object(ne.registerLocale)("it",re.a),Object(ne.registerLocale)("it",re.a);n(300);var ce=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(a.Fragment,null,r.a.createElement(b.LinkContainer,{to:"/group/".concat(this.props.id)},r.a.createElement(v.a,{className:"group-card",style:{flex:1}},r.a.createElement(v.a.Header,null,r.a.createElement("h4",null,this.props.name)),r.a.createElement(v.a.Body,null,r.a.createElement("h6",null,"Partecipanti"),this.props.profiles.map((function(t){return r.a.createElement(C,{key:"".concat(e.props.id,"_").concat(t.id),variant:"primary",profile:t})}))),r.a.createElement(v.a.Footer,null,r.a.createElement(C,{variant:"warning",profile:this.props.creator}),r.a.createElement("span",{className:"float-right"},this.props.date_creation)))))}}]),t}(a.Component),se=n(212),le=n(401),ue=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).colProps={xs:"12",sm:"12",md:"6",lg:"4",xl:"3"},n.renderGroupCards=function(){var e=[];return n.props.loading||n.props.groups.forEach((function(t){return e.push(r.a.createElement(se.a,Object.assign({},n.colProps,{style:{marginBottom:"10px"},key:t.id}),r.a.createElement(ce,Object.assign({key:t.id},t))))})),r.a.createElement(le.a,null,e)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,this.props.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):this.renderGroupCards())}}]),t}(a.Component),pe=n(408),de=n(30),me=(n(301),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={selected:!1},n.divStyle={margin:"10px",width:"".concat(n.imgSize,"px"),wordWrap:"break-word",textAlign:"center"},n.legendStyle={textAlign:"center",fontSize:"15px"},n.onSelectClick=function(){var e=!n.state.selected;n.setState({selected:e}),n.props.selectFriend(n.props.friend.id)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.setState({selected:this.props.selected})}},{key:"render",value:function(){var e=this.state.selected?"selected":"",t=this.props.friend.picture?this.props.friend.picture:A.a;return r.a.createElement(a.Fragment,null,r.a.createElement("div",{style:this.divStyle},this.props.selectable?r.a.createElement(k.a,{src:t,className:"profile-pic-medium friend-image ".concat(e),onClick:this.onSelectClick}):r.a.createElement(de.Link,{to:"/profile/".concat(this.props.friend.username)},r.a.createElement(k.a,{src:t,className:"profile-pic-medium friend-image ".concat(e)})),r.a.createElement("legend",{style:this.legendStyle},this.props.friend.username)))}}]),t}(a.Component)),he=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"d-flex justify-content-center flex-wrap"},this.props.friends.map((function(e){return r.a.createElement(me,{key:e.username,friend:e})})))}}]),t}(a.Component),fe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={friends:[]},n.search=function(){var e=String(document.getElementById("search-friend").value).toLowerCase(),t=n.props.friends.filter((function(t){return String(t.username).toLowerCase().includes(e)||n.props.selectedFriends.includes(t.id)}));n.setState({friends:t})},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.setState({friends:this.props.friends})}},{key:"render",value:function(){var e=this;return r.a.createElement(a.Fragment,null,r.a.createElement(pe.a.Control,{id:"search-friend",type:"text",placeholder:"Cerca per username",onChange:this.search}),r.a.createElement("div",{className:"d-flex justify-content-center flex-wrap"},this.state.friends.map((function(t){var n=e.props.selectedFriends.includes(t.id);return r.a.createElement(me,{key:t.username,friend:t,selectable:!0,selectFriend:e.props.selectFriend,selected:n})}))))}}]),t}(a.Component),ve=Object($.b)((function(e){return{currentUser:e.currentUser}}))((function(e){return r.a.createElement(pe.a,{onSubmit:e.onSubmit},r.a.createElement(pe.a.Group,{controlId:"name"},r.a.createElement(pe.a.Label,null,"Nome gruppo"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:e.defaultname})),r.a.createElement(le.a,null,r.a.createElement(se.a,null,r.a.createElement(pe.a.Group,{controlId:"date_start"},r.a.createElement(pe.a.Label,null,"Data partenza"),r.a.createElement("br",null),r.a.createElement(ie,{selected:e.dateStart,onChange:function(t){return e.setDateStart(t)}}))),r.a.createElement(se.a,null,r.a.createElement(pe.a.Group,{controlId:"date_finish"},r.a.createElement(pe.a.Label,null,"Data ritorno"),r.a.createElement("br",null),r.a.createElement(ie,{selected:e.dateFinish,onChange:function(t){return e.setDateFinish(t)},minDate:e.dateStart})))),r.a.createElement(pe.a.Group,{controlId:"description"},r.a.createElement(pe.a.Label,null,"Descrizione"),r.a.createElement(pe.a.Control,{as:"textarea",rows:"10",defaultValue:e.defaultDescription})),r.a.createElement("h3",null,"Aggiungi amici"),r.a.createElement(fe,{friends:e.profiles,selectFriend:e.selectFriend,selectedFriends:e.selectedFriends}),r.a.createElement(g.a,{type:"submit"},"Invia!"))})),Ee=n(406),ge=n(402),be=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.alert;return r.a.createElement(ge.a,{variant:t.style,style:{marginBottom:"0"},key:t.id,onClose:function(){return e.props.removeAlert(t.id)},dismissible:!0},t.text)}}]),t}(a.Component),ye=Object($.b)(null,(function(e){return{removeAlert:function(t){return e(function(e){return{type:"REMOVE_ALERT",id:e}}(t))}}}))(be),Oe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderAlerts=function(e,t){return e.map((function(e){return r.a.cloneElement(t,{alert:e,key:e.id})}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.alerts,n=e.children;return r.a.createElement("div",null,this.renderAlerts(t,n))}}]),t}(a.Component),Se=(n(303),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(a.Fragment,null,r.a.createElement(Ee.a,{as:v.a,className:this.props.type,show:this.props.show,onHide:this.props.onHide,size:"xl",centered:!0},r.a.createElement(v.a.Header,null,r.a.createElement(Ee.a.Title,null,this.props.header,r.a.createElement(E.a,{className:"float-right"},r.a.createElement(g.a,{variant:"warning",onClick:function(){return e.props.onHide()}},"Chiudi")))),r.a.createElement(v.a.Body,null,r.a.createElement(Oe,{alerts:this.props.alerts},r.a.createElement(ye,null)),this.props.body),this.props.footer&&r.a.createElement(v.a.Footer,null,this.props.footer)))}}]),t}(r.a.Component)),je=Object($.b)((function(e){return{alerts:e.alerts}}))(Se),Ce=function(e){if(null!==e){return e.toLocaleString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"}).split(",")[0]}return e},Ie=function(e){if(null===e)return null;var t=e.split("/");return new Date(t[2],t[1]-1,t[0])},ke=function(e,t,n){return!(null!==e&&null!==t&&t<e)||(n("La data di ritorno non pu\xf2 precedere la data di partenza","warning"),!1)},we=function(e,t,n,a){return!(null!==e&&null!==t&&null!==n&&t<n&&(e<t||e>n))||(a("La data selezionata non \xe8 compresa fra la data di partenza e la data di ritorno","warning"),!1)},Ae=function(e,t){return Math.floor((t-e)/864e5)+1},Te=function(e,t){var n=new Date(e);return new Date(n.getTime()+864e5*t)},Fe=function(e){if(null!==e){return e.toLocaleString("it-IT",{hour12:!1,hour:"2-digit",minute:"2-digit"}).split(",")[0]}return e},De=function(e){if(null===e)return null;var t=e.split(":"),n=new Date;return new Date(n.getFullYear(),n.getMonth(),n.getDate(),t[0],t[1])},Re=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showCreate:!1,selectedFriends:[],dateStart:null,dateFinish:null},n.setDateStart=function(e){return n.setState({dateStart:e})},n.setDateFinish=function(e){return n.setState({dateFinish:e})},n.deselectFriend=function(e){var t=Object(m.a)(n.state.selectedFriends),a=t.indexOf(e);-1!==a&&(t.splice(a,1),n.setState({selectedFriends:t}))},n.selectFriend=function(e){n.state.selectedFriends.includes(e)?n.deselectFriend(e):n.setState({selectedFriends:[].concat(Object(m.a)(n.state.selectedFriends),[e])})},n.showCreate=function(){n.setState({showCreate:!n.state.showCreate})},n.postGroup=function(e,t,a,r,i){var o=localStorage.getItem("token"),c={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(o)}};return F.a.post("".concat(_),{name:e,description:t,profiles:a,date_start:r,date_finish:i},c).then((function(e){n.props.addGroup(e.data),n.showCreate()})).catch((function(e){n.props.error(e)}))},n.handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.name.value,r=t.description.value,i=n.state.selectedFriends,o=n.state,c=o.dateStart,s=o.dateFinish;ke(c,s,n.props.addAlert)&&(c=Ce(c),s=Ce(s),n.postGroup(a,r,i,c,s))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.currentUser.loading||this.setState({selectedFriends:[this.props.currentUser.id]})}},{key:"componentDidUpdate",value:function(e,t){e.currentUser.id!==this.props.currentUser.id&&this.setState({selectedFriends:[].concat(Object(m.a)(this.state.selectedFriends),[this.props.currentUser.id])})}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(g.a,{variant:"danger",onClick:this.showCreate},"Crea"),r.a.createElement(je,{show:this.state.showCreate,onHide:this.showCreate,type:"group-modal",header:"Crea gruppo",body:r.a.createElement(ve,{onSubmit:this.handleSubmit,selectFriend:this.selectFriend,selectedFriends:this.state.selectedFriends,profiles:this.props.currentUser.profile.friends,dateStart:this.state.dateStart,dateFinish:this.state.dateFinish,setDateStart:this.setDateStart,setDateFinish:this.setDateFinish})}))}}]),t}(a.Component),Ue=Object(d.o)(Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))},addAlert:function(t,n){return e(q(t,n))}}}))(Re)),_e=n(19),xe=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(Ee.a,{className:"confirm-modal",show:this.props.show,onHide:this.props.onHide,centered:!0},r.a.createElement(Ee.a.Header,{closeButton:!0},r.a.createElement(Ee.a.Title,null,"Sei sicuro?")),r.a.createElement(Ee.a.Body,null,r.a.createElement(g.a,{variant:"danger",onClick:this.props.onClick},"Sicurissimo!")))}}]),t}(a.Component),Ne=(n(304),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showUpdate:!1,showModalDelete:!1,editing:!1},n.showUpdate=function(){n.setState({showUpdate:!n.state.showUpdate,editing:!1})},n.showModalDelete=function(){n.setState({showModalDelete:!n.state.showModalDelete})},n.showEditFormInModal=function(){n.setState({editing:!n.state.editing})},n.putIdea=function(e){e.preventDefault();var t=e.currentTarget,a=t.title.value,r=t.description.value,i=localStorage.getItem("token"),o={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(i)}};return F.a.put("".concat(N).concat(n.props.id,"/"),{title:a,description:r},o).then((function(e){n.props.updateIdeaInState(e.data).then((function(){n.props.updateIdeaInStore(e.data),n.setState({editing:!1})}))})).catch((function(e){n.props.error(e)}))},n.doesCurrentUserOwnThisIdea=function(){return!(!n.props.creator||n.props.currentUser.id!==n.props.creator.id)},n.handleDelete=function(){n.props.deleteIdea(n.props.id).then((function(){n.setState({editing:!1}),n.showModalDelete()}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(v.a,{className:"idea-card"},r.a.createElement(v.a.Header,null,r.a.createElement("h4",null,this.props.title,this.doesCurrentUserOwnThisIdea()&&r.a.createElement(g.a,{className:"float-right",variant:"danger",onClick:this.showModalDelete},r.a.createElement(_e.t,null)))),r.a.createElement(v.a.Body,{className:"card-body text-with-newline",onClick:this.showUpdate},this.props.description),r.a.createElement(v.a.Footer,null,r.a.createElement(C,{profile:this.props.creator,variant:"warning"}),r.a.createElement("span",{className:"float-right"},this.props.date_creation))),r.a.createElement(je,{show:this.state.showUpdate,onHide:this.showUpdate,type:"idea-modal",header:this.props.title,body:r.a.createElement(Ye,Object.assign({},this.props,{doesCurrentUserOwnThisIdea:this.doesCurrentUserOwnThisIdea,putIdea:this.putIdea,showEditFormInModal:this.showEditFormInModal,editing:this.state.editing})),footer:r.a.createElement(a.Fragment,null,r.a.createElement(C,{profile:this.props.creator,variant:"warning"}),r.a.createElement("span",{className:"float-right"},this.props.date_creation))}),r.a.createElement(xe,{show:this.state.showModalDelete,onHide:this.showModalDelete,onClick:this.handleDelete}))}}]),t}(a.Component)),Me=Object(d.o)(Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{updateIdeaInStore:function(t){return e(function(e){return{type:"UPDATE_IDEA_IN_STORE",idea:e}}(t))},error:function(t){return e(P(t))}}}))(Ne)),Le=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderIdeaCards=function(){var e=[],t=n.props.ideas;return t&&t.forEach((function(t){return e.push(r.a.createElement(Me,Object.assign({key:t.id},t,{deleteIdea:n.props.deleteIdea,updateIdeaInState:n.props.updateIdeaInState})))})),e},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"overflow-auto"},this.renderIdeaCards())}}]),t}(a.Component),ze=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(pe.a,{onSubmit:this.props.onSubmit},r.a.createElement(pe.a.Group,{controlId:"title"},r.a.createElement(pe.a.Label,null,"Titolo"),r.a.createElement(pe.a.Control,{type:"text",placeholder:"Bellissima vacanza a...",defaultValue:this.props.defaultTitle})),r.a.createElement(pe.a.Group,{controlId:"description"},r.a.createElement(pe.a.Label,null,"Descrizione"),r.a.createElement(pe.a.Control,{as:"textarea",rows:"10",defaultValue:this.props.defaultDescription})),r.a.createElement(g.a,{variant:"success",type:"submit"},"Invia"))}}]),t}(a.Component),Ge=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showCreate:!1},n.showCreate=function(){n.setState({showCreate:!n.state.showCreate})},n.handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.title.value,r=t.description.value,i=localStorage.getItem("token"),o={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(i)}};return F.a.post("".concat(N),{title:a,description:r},o).then((function(e){n.props.addIdeaToState(e.data).then((function(){n.showCreate(),n.props.removeAllAlerts(),n.props.addIdeaToStore(e.data)}))})).catch((function(e){n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(g.a,{variant:"info",onClick:this.showCreate},"Crea"),r.a.createElement(je,{show:this.state.showCreate,type:"idea-modal",header:"Crea idea",onHide:this.showCreate,body:r.a.createElement(ze,{onSubmit:this.handleSubmit})}))}}]),t}(a.Component),qe=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))},addIdeaToStore:function(t){return e(function(e){return{type:"ADD_IDEA_TO_STORE",idea:e}}(t))},removeAllAlerts:function(){return e({type:"REMOVE_ALL_ALERTS"})}}}))(Ge),Pe=(n(168),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"".concat(this.props.kind,"-comment")},this.props.currentUserId===this.props.creator.id&&r.a.createElement(g.a,{size:"sm",variant:"danger",className:"float-right",onClick:function(){return e.props.deleteComment(e.props.id)}},"Elimina"),r.a.createElement("h5",null,r.a.createElement(C,{profile:this.props.creator,variant:"warning"})),r.a.createElement("div",{className:"text-with-newline"},this.props.text),r.a.createElement("div",{style:{fontStyle:"italic",fontSize:"10pt",textAlign:"right"}},this.props.datetime))}}]),t}(a.Component)),Be=Object($.b)((function(e){return{currentUserId:e.currentUser.id}}))(Pe),He=n(403),Ve=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){n.props.addComment(document.getElementById("commentText").value),document.getElementById("commentText").value=""},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"".concat(this.props.kind,"-comment")},r.a.createElement(He.a,{className:"input-group-prepend"},r.a.createElement(g.a,{variant:"success",onClick:this.onClick},"Commenta"),r.a.createElement("textarea",{id:"commentText",className:"form-control",rows:"3"})))}}]),t}(a.Component),Qe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={comments:[],loading:!0},n.getCommentUrl=function(){switch(n.props.kind){case"idea":return"https://holpoint.ns0.it/api/comment/idea/";case"activity":return"https://holpoint.ns0.it/api/comment/activity/";default:return}},n.addComment=function(e){if(""!==e){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}},r=n.getCommentUrl();return F.a.post(r,{text:e,to:n.props.id},a).then((function(e){n.setState({comments:[].concat(Object(m.a)(n.state.comments),[e.data])})})).catch((function(e){n.props.error(e)}))}},n.deleteComment=function(e){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}},r=n.getCommentUrl();return F.a.delete("".concat(r).concat(e,"/"),a).then((function(t){n.setState({comments:n.state.comments.filter((function(t){return t.id!==e}))})})).catch((function(e){n.props.error(e)}))},n.renderComments=function(){var e=[];return n.state.comments&&n.state.comments.forEach((function(t){return e.push(r.a.createElement(Be,Object.assign({},t,{key:t.id,deleteComment:n.deleteComment,kind:n.props.kind})))})),e},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("token"),n={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}},a=this.getCommentUrl();return F.a.get("".concat(a).concat(this.props.id),n).then((function(t){e.setState({loading:!1,comments:t.data})})).catch((function(t){e.props.error(t)}))}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement("h3",null,"Commenti"),r.a.createElement(Ve,{addComment:this.addComment,kind:this.props.kind}),this.state.loading?r.a.createElement(f.a,{striped:!0,variant:"info",now:100,animated:!0}):r.a.createElement("div",null,this.renderComments()))}}]),t}(a.Component),We=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))}}}))(Qe),Ye=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,this.props.doesCurrentUserOwnThisIdea()&&r.a.createElement(E.a,{className:"float-right"},r.a.createElement(g.a,{variant:"warning",onClick:this.props.showEditFormInModal},this.props.editing?"Annulla":"Modifica")),this.props.editing?r.a.createElement(ze,{onSubmit:this.props.putIdea,defaultTitle:this.props.title,defaultDescription:this.props.description}):r.a.createElement(a.Fragment,null,r.a.createElement("h3",null,"Descrizione"),r.a.createElement("div",{className:"lead text-with-newline"},this.props.description)),r.a.createElement("div",{style:{marginTop:"10px"}},r.a.createElement(We,Object.assign({},this.props,{kind:"idea"}))))}}]),t}(a.Component),Je=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showCreate:!1,ideas:[]},n.addIdeaToListNoDuplicates=function(){if(!n.props.currentUser.loading){var e=n.props.groupIdeas.map((function(e){return e.id})),t=n.props.currentUser.profile.ideas;t=t.filter((function(t){return!e.includes(t.id)})),n.setState({ideas:t})}},n.showCreate=function(){n.setState({showCreate:!n.state.showCreate})},n.handleSubmit=function(e){e.preventDefault();var t=Object(m.a)(document.querySelectorAll("input[name=ideas]:checked")).map((function(e){return parseInt(e.id)}));0!==t.length?n.props.addIdeaToState(t).then((function(){n.showCreate(),n.props.removeAllAlerts()})):n.props.addAlert("Nessuna idea selezionata","warning")},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.addIdeaToListNoDuplicates()}},{key:"componentDidUpdate",value:function(e,t){e.currentUser.id===this.props.currentUser.id&&e.groupIdeas===this.props.groupIdeas||this.addIdeaToListNoDuplicates()}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(g.a,{variant:"info",onClick:this.showCreate},"Aggiungi"),r.a.createElement(je,{show:this.state.showCreate,type:"idea-modal",header:"Aggiungi idea",onHide:this.showCreate,body:r.a.createElement(Xe,{onSubmit:this.handleSubmit,ideas:this.state.ideas,type:"checkbox"})}))}}]),t}(a.Component),Ke=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{addAlert:function(t,n){return e(q(t,n))},removeAllAlerts:function(){return e({type:"REMOVE_ALL_ALERTS"})}}}))(Je),Xe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderCheckBoxes=function(){var e=[];return n.props.ideas.forEach((function(t){e.push(r.a.createElement(pe.a.Check,{custom:!0,style:{fontSize:"20px"},type:n.props.type,key:t.id,id:t.id,label:t.title,name:"ideas"}))})),e},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,0!==this.props.ideas.length?r.a.createElement(pe.a,{onSubmit:this.props.onSubmit},this.renderCheckBoxes(),r.a.createElement(g.a,{type:"submit",variant:"success"},"Invia")):r.a.createElement("div",{style:{textAlign:"center",fontSize:"30px"}},"Non ci sono idee :/"))}}]),t}(a.Component),$e=(n(305),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={gti:{}},n.hasCurrentUserVotedThisIdea=function(){var e=n.props.currentUser.id;return!!n.state.gti.votes&&Boolean(n.state.gti.votes.map((function(e){return e.id})).find((function(t){return t===e})))},n.vote=function(e,t){var a=localStorage.getItem("token"),r={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(a)}};return F.a.post("".concat(M).concat(e,"/").concat(t),{},r).then((function(e){n.setState({gti:e.data})})).catch((function(e){n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.setState({gti:this.props.gti})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{marginBottom:"20px"}},r.a.createElement("div",{className:"vote-panel"},r.a.createElement(et,{votes:this.state.gti.votes},r.a.createElement("h4",{style:{margin:"auto",textAlign:"center"}},"Voti: ",this.state.gti.votes&&this.state.gti.votes.length)),this.hasCurrentUserVotedThisIdea()?r.a.createElement(g.a,{style:{width:"60px",color:"white"},variant:"success",onClick:function(){e.vote(e.state.gti.group,e.state.gti.idea)}},r.a.createElement(_e.r,null)):r.a.createElement(g.a,{style:{width:"60px",color:"black",backgroundColor:"white"},variant:"outline-success",onClick:function(){e.vote(e.state.gti.group,e.state.gti.idea)}},r.a.createElement(_e.p,null))),r.a.createElement("div",null,this.props.ideaCard))}}]),t}(a.Component)),Ze=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))}}}))($e),et=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(O.a,{placement:"top",overlay:this.props.votes&&r.a.createElement(S.a,null,this.props.votes.length>0?this.props.votes.map((function(e){return r.a.createElement("div",{key:e.username},e.username)})):r.a.createElement("div",null,"Nessun voto"))},this.props.children)}}]),t}(a.Component),tt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).colProps={xs:"12",sm:"12",md:"6",lg:"6",xl:"4"},n.renderIdeaCards=function(){var e=[],t=n.props,a=t.ideas,i=t.group_to_idea;return i&&i.forEach((function(t){var i=a.find((function(e){return e.id===t.idea}));e.push(r.a.createElement(se.a,Object.assign({},n.colProps,{key:i.id}),r.a.createElement(Ze,{count:t.votes.length,gti:t,ideaCard:r.a.createElement(Me,Object.assign({key:i.id},i,{deleteIdea:n.props.deleteIdea,updateIdeaInState:n.props.updateIdeaInState}))})))})),r.a.createElement(le.a,null,e)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.renderIdeaCards()}}]),t}(a.Component),nt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={editing:!1,showModalDelete:!1,showModalFavIdea:!1,profiles:[]},n.showModalDelete=function(){n.setState({showModalDelete:!n.state.showModalDelete})},n.showModalFavIdea=function(){n.setState({showModalFavIdea:!n.state.showModalFavIdea})},n.edit=function(){window.scrollTo(0,0),n.setState({editing:!n.state.editing})},n.addProfileToListNoDuplicates=function(){if(!n.props.currentUser.loading){var e=n.props.currentUser.profile.friends,t=[];if(e){var a=e.map((function(e){return e.id})),r=n.props.profiles.filter((function(e){return!a.includes(e.id)}));t=e.concat(r)}else t=e;t=t.filter((function(e){return e.id!==n.props.creator.id})),n.setState({profiles:t})}},n.onSubmitDelete=function(){n.props.deleteGroup()},n.onSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.name.value,r=t.description.value,i=n.props.selectedFriends,o=n.props,c=o.dateStart,s=o.dateFinish;if(ke(c,s,n.props.addAlert)){c=Ce(c),s=Ce(s);var l=n.props.ideas.map((function(e){return e.id}));n.props.putGroup(a,r,i,l,c,s).then((function(e){e||n.setState({editing:!1})}))}},n.isCreator=function(){return n.props.currentUser.id===n.props.creator.id},n.selectFavIdea=function(e){e.preventDefault();var t=document.querySelector("input[name=ideas]:checked");t?n.props.putFavIdea(t.id).then((function(){n.showModalFavIdea(),n.props.removeAllAlerts()})):n.props.addAlert("Nessuna idea selezionata","warning")},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.addProfileToListNoDuplicates()}},{key:"componentDidUpdate",value:function(e,t){e.currentUser.id!==this.props.currentUser.id&&this.addProfileToListNoDuplicates()}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(E.a,{className:"float-right"},r.a.createElement(g.a,{variant:"warning",onClick:this.edit},this.state.editing?"Annulla":"Modifica"),this.isCreator()&&r.a.createElement(a.Fragment,null,r.a.createElement(g.a,{variant:"success",onClick:this.showModalFavIdea},"Seleziona idea preferita"),r.a.createElement(g.a,{variant:"danger",onClick:this.showModalDelete},"Elimina"))),this.state.editing?r.a.createElement(ve,{onSubmit:this.onSubmit,defaultname:this.props.name,defaultDescription:this.props.description,profiles:this.state.profiles,selectFriend:this.props.selectFriend,selectedFriends:this.props.selectedFriends,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish,setDateStart:this.props.setDateStart,setDateFinish:this.props.setDateFinish}):r.a.createElement(rt,this.props),r.a.createElement(xe,{show:this.state.showModalDelete,onHide:this.showModalDelete,onClick:this.onSubmitDelete}),r.a.createElement(je,{show:this.state.showModalFavIdea,type:"idea-modal",header:"Seleziona idea preferita",onHide:this.showModalFavIdea,body:r.a.createElement(Xe,{onSubmit:this.selectFavIdea,ideas:this.props.ideas,type:"radio"})}))}}]),t}(a.Component),at=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{addAlert:function(t,n){return e(q(t,n))},removeAllAlerts:function(){return e({type:"REMOVE_ALL_ALERTS"})}}}))(nt);function rt(e){return r.a.createElement(a.Fragment,null,r.a.createElement("div",null,"Creato da: ",r.a.createElement(C,{profile:e.creator,variant:"danger",placement:"right"})),r.a.createElement("div",null,"Data partenza: ",e.dateStart?Ce(e.dateStart):"non definita"),r.a.createElement("div",null,"Data ritorno: ",e.dateFinish?Ce(e.dateFinish):"non definita"),r.a.createElement("div",null,"Partecipanti:"," ",e.profiles.map((function(e){return r.a.createElement(C,{profile:e,key:e.id,variant:"primary",placement:"bottom"})}))),r.a.createElement("div",null,"Idea preferita:"," ",r.a.createElement(j.a,{variant:"success"},e.prefered_idea?e.prefered_idea.title:"non definita")),r.a.createElement("hr",null),r.a.createElement("div",{className:"text-with-newline lead"},e.description))}var it=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).divStyle={marginTop:"10px",marginBottom:"20px"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:this.divStyle},r.a.createElement("h1",null,this.props.title," ",this.props.badge),this.props.component)}}]),t}(a.Component),ot=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(it,{title:this.props.group.name,component:r.a.createElement(at,Object.assign({},this.props.group,{selectFriend:this.props.selectFriend,selectedFriends:this.props.selectedFriends,putGroup:this.props.putGroup,deleteGroup:this.props.deleteGroup,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish,setDateStart:this.props.setDateStart,setDateFinish:this.props.setDateFinish,putFavIdea:this.props.putFavIdea}))}),r.a.createElement(it,{title:"Idee proposte",component:r.a.createElement(tt,{ideas:this.props.group.ideas,deleteIdea:this.props.removeIdeaFromGroup,updateIdeaInState:this.props.updateIdeaInState,group_to_idea:this.props.group.group_to_idea}),badge:r.a.createElement(E.a,null,r.a.createElement(qe,{addIdeaToState:this.props.addIdeaToState}),r.a.createElement(Ke,{addIdeaToState:this.props.addIdeaIdsListForPutGroup,groupIdeas:this.props.group.ideas}))}))}}]),t}(a.Component),ct=n(75),st=n(20),lt=(n(169),n(82)),ut={GEN:{kind:"GEN",name:"Generico"},SPO:{kind:"SPO",name:"Spostamento"},PER:{kind:"PER",name:"Pernottamento"},RIS:{kind:"RIS",name:"Ristorante"},VIS:{kind:"VIS",name:"Visita"},ESC:{kind:"ESC",name:"Escursione"},SVA:{kind:"SVA",name:"Svago"},ACQ:{kind:"ACQ",name:"Acquisti"}},pt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(pe.a,{onSubmit:this.props.onSubmit},r.a.createElement(pe.a.Group,{controlId:"title"},r.a.createElement(pe.a.Label,null,"Titolo"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.defaultTitle})),r.a.createElement(pe.a.Group,{controlId:"kind"},r.a.createElement(pe.a.Label,null,"Tipo"),r.a.createElement(pe.a.Control,{as:"select",defaultValue:this.props.defaultKind},Object.keys(ut).map((function(e){return r.a.createElement("option",{key:e,value:e},ut[e].name)})))),r.a.createElement(pe.a.Row,null,r.a.createElement(pe.a.Group,{as:se.a,controlId:"date"},r.a.createElement(pe.a.Label,null,"Data"),r.a.createElement("br",null),r.a.createElement(ie,{selected:this.props.date,onChange:function(t){return e.props.setDate(t)},minDate:this.props.dateStart,maxDate:this.props.dateFinish})),r.a.createElement(pe.a.Group,{as:se.a,controlId:"time"},r.a.createElement(pe.a.Label,null,"Ora"),r.a.createElement("br",null),r.a.createElement(oe,{selected:this.props.time,onChange:function(t){return e.props.setTime(t)}}))),r.a.createElement(pe.a.Group,{controlId:"url"},r.a.createElement(pe.a.Label,null,"URL"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.defaultUrl})),r.a.createElement(pe.a.Group,{controlId:"description"},r.a.createElement(pe.a.Label,null,"Descrizione"),r.a.createElement(pe.a.Control,{as:"textarea",rows:"10",defaultValue:this.props.defaultDescription})),r.a.createElement(g.a,{variant:"warning",type:"submit"},"Invia"))}}]),t}(a.Component),dt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={date:Ie(n.props.activity.date),time:De(n.props.activity.time)},n.setDate=function(e){return n.setState({date:e})},n.setTime=function(e){return n.setState({time:e})},n.handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.title.value,r=t.description.value,i=t.url.value,o=t.kind.value,c=n.state,s=c.date,l=c.time;we(s,n.props.dateStart,n.props.dateFinish,n.props.addAlert)&&(s=Ce(s),l=Fe(l),n.props.putActivity(a,r,i,s,l,o))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.activity;return r.a.createElement(a.Fragment,null,r.a.createElement(E.a,{className:"float-right"},r.a.createElement(g.a,{variant:"warning",onClick:this.props.showEditFormInModal},this.props.editing?"Annulla":"Modifica"),this.props.doesCurrentUserOwnThisActivity()&&r.a.createElement(g.a,{variant:"danger",onClick:this.props.showModalDelete},"Elimina")),this.props.editing?r.a.createElement(pt,Object.assign({},this.props,{onSubmit:this.handleSubmit,date:this.state.date,time:this.state.time,setDate:this.setDate,setTime:this.setTime,defaultTitle:e.title,defaultDescription:e.description,defaultUrl:e.url,defaultKind:e.kind})):r.a.createElement(a.Fragment,null,r.a.createElement("h6",null,"Categoria: ",ut[e.kind].name),r.a.createElement("h6",null,"Data: ",e.date?e.date:"Non definita"),r.a.createElement("h6",null,"Ora: ",e.time?e.time:"Non definita"),e.url&&r.a.createElement("h6",{className:"activity-url"},"URL: ",r.a.createElement("a",{href:e.url},e.url)),e.description&&r.a.createElement(a.Fragment,null,r.a.createElement("h3",null,"Descrizione"),r.a.createElement("div",{className:"lead text-with-newline"},e.description))),r.a.createElement(We,{id:this.props.activity.id,kind:"activity"}))}}]),t}(a.Component),mt=Object($.b)(null,(function(e){return{addAlert:function(t,n){return e(q(t,n))}}}))(dt),ht=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i))))._isMounted=!1,n.state={showUpdate:!1,showModalDelete:!1,editing:!1},n.showUpdate=function(){return n._isMounted&&n.setState({showUpdate:!n.state.showUpdate,editing:!1})},n.showModalDelete=function(){return n._isMounted&&n.setState({showModalDelete:!n.state.showModalDelete})},n.showEditFormInModal=function(){return n._isMounted&&n.setState({editing:!n.state.editing})},n.componentDidMount=function(){return n._isMounted=!0},n.componentWillUnmount=function(){return n._isMounted=!1},n.getCardIcon=function(){switch(n.props.activity.kind){case"GEN":return r.a.createElement(_e.a,null);case"SPO":return r.a.createElement(_e.b,null);case"PER":return r.a.createElement(_e.k,null);case"RIS":return r.a.createElement(_e.z,null);case"VIS":return r.a.createElement(_e.u,null);case"ESC":return r.a.createElement(_e.m,null);case"SVA":return r.a.createElement(_e.n,null);case"ACQ":return r.a.createElement(_e.q,null);default:return""}},n.doesCurrentUserOwnThisActivity=function(){return!(!n.props.activity.creator||n.props.currentUser.id!==n.props.activity.creator.id)},n.putActivity=function(e,t,a,r,i,o){var c=localStorage.getItem("token"),s={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(c)}};return F.a.put("".concat(z).concat(n.props.group.id,"/").concat(n.props.activity.id),{title:e,description:t,url:a,date:r,time:i,kind:o},s).then((function(e){n._isMounted&&(n.props.updateActivityInState(e.data),n.showEditFormInModal())})).catch((function(e){return n.props.error(e)}))},n.deleteActivity=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.delete("".concat(G).concat(n.props.activity.id,"/"),t).then((function(e){n._isMounted&&n.props.removeActivityFromState(n.props.activity.id)})).catch((function(e){return n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.activity;return r.a.createElement(a.Fragment,null,r.a.createElement(lt.b,{key:this.props.activityId,draggableId:this.props.activity.id,index:this.props.index},(function(n,i){return r.a.createElement(a.Fragment,null,r.a.createElement(v.a,Object.assign({onClick:e.showUpdate,className:"activity-card mb-2"},n.draggableProps,n.dragHandleProps,{ref:n.innerRef,style:Object(st.a)({backgroundColor:i.isDragging?"var(--holpoint-yellow)":"var(--holpoint-green)"},n.draggableProps.style)}),r.a.createElement(v.a.Header,null,e.getCardIcon(),r.a.createElement("span",{className:"float-right"},t.title)),r.a.createElement(v.a.Footer,null,r.a.createElement(C,{profile:t.creator,variant:"danger"}),r.a.createElement("span",{className:"float-right"},t.time||"N/D"))),r.a.createElement(je,{show:e.state.showUpdate,onHide:e.showUpdate,type:"activity-modal",header:r.a.createElement(a.Fragment,null,e.getCardIcon(),r.a.createElement("span",{className:"ml-3"},t.title)),body:r.a.createElement(mt,Object.assign({},e.props,{doesCurrentUserOwnThisActivity:e.doesCurrentUserOwnThisActivity,putActivity:e.putActivity,showEditFormInModal:e.showEditFormInModal,showModalDelete:e.showModalDelete,editing:e.state.editing})),footer:r.a.createElement(a.Fragment,null,r.a.createElement(C,{profile:e.props.activity.creator,variant:"danger"}),r.a.createElement("span",{className:"float-right"},e.props.activity.date))}))})),r.a.createElement(xe,{show:this.state.showModalDelete,onHide:this.showModalDelete,onClick:this.deleteActivity}))}}]),t}(a.Component),ft=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))}}}))(ht),vt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={showCreate:!1,date:null,time:null},n.showCreate=function(){return n.setState({showCreate:!n.state.showCreate})},n.setDate=function(e){return n.setState({date:e})},n.setTime=function(e){return n.setState({time:e})},n.postActivity=function(e,t,a,r,i,o){var c=localStorage.getItem("token"),s={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(c)}};return F.a.post(G,{group:n.props.group.id,title:e,description:t,url:a,date:r,time:i,kind:o},s).then((function(e){n.props.addActivityToState(e.data),n.showCreate()})).catch((function(e){return n.props.error(e)}))},n.handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.title.value,r=t.description.value,i=t.url.value,o=t.kind.value,c=n.state,s=c.date,l=c.time;we(s,n.props.dateStart,n.props.dateFinish,n.props.addAlert)&&(s=Ce(s),l=Fe(l),n.postActivity(a,r,i,s,l,o))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.columnDate&&this.setState({date:this.props.columnDate})}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(g.a,{variant:"plain",style:{backgroundColor:"var(--holpoint-green)",color:"white"},onClick:this.showCreate,size:this.props.size,className:this.props.className},"Crea"),r.a.createElement(je,{show:this.state.showCreate,type:"activity-modal",header:"Crea Attivit\xe0",onHide:this.showCreate,body:r.a.createElement(pt,{onSubmit:this.handleSubmit,date:this.state.date,time:this.state.time,setDate:this.setDate,setTime:this.setTime,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish})}))}}]),t}(a.Component),Et=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))},addAlert:function(t,n){return e(q(t,n))}}}))(vt),gt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"title"},this.props.column.title,"default"!==this.props.column.id&&r.a.createElement(E.a,{className:"float-right"},r.a.createElement(g.a,{variant:"info",size:"sm",onClick:function(){return e.props.sortActivityIndexesByTime(e.props.column)}},r.a.createElement(_e.e,null)),r.a.createElement(Et,{size:"sm",columnDate:Ie(this.props.column.title),group:this.props.group,addActivityToState:this.props.addActivityToState,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish})))),r.a.createElement(lt.c,{droppableId:this.props.column.id},(function(t,n){return r.a.createElement("div",Object.assign({className:"column",ref:t.innerRef},t.droppableProps,{style:{backgroundColor:n.isDraggingOver?"var(--holpoint-red)":"var(--holpoint-light-green)",borderColor:n.isDraggingOver?"var(--holpoint-dark-red)":"var(--holpoint-green)"}}),e.props.activities.map((function(t,n){return r.a.createElement(ft,{key:t.id,activity:t,group:e.props.group,index:n,updateActivityInState:e.props.updateActivityInState,removeActivityFromState:e.props.removeActivityFromState,dateStart:e.props.dateStart,dateFinish:e.props.dateFinish})})),t.placeholder)})))}}]),t}(a.Component),bt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,activities:[],columns:{default:{id:"default",title:"Non assegnate",actIds:[]}},columnOrder:["default"]},n.createColumnsFromDates=function(e,t){for(var a=n.state,r=a.columns,i=a.columnOrder,o=0;o<Ae(e,t);o++){var c=Ce(Te(e,o));r[c]={id:c,title:c,actIds:[]},i.push(c)}return n.setState({columnOrder:i}),r},n.compareIndexes=function(e,t){return e.index>t.index?1:t.index>e.index?-1:0},n.addActivitiesToColumns=function(e,t){for(var a in e.forEach((function(e){e.date in t?!t[e.date].actIds.includes(e.id)&&t[e.date].actIds.push(e.id):!t.default.actIds.includes(e.id)&&t.default.actIds.push(e.id)})),t)t[a].actIds=t[a].actIds.map((function(t){return e.find((function(e){return e.id===t}))})),t[a].actIds.sort(n.compareIndexes),t[a].actIds=t[a].actIds.map((function(e){return e.id}));return t},n.getActivities=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.get("".concat(z).concat(n.props.group.id,"/0"),t).then((function(e){var t=n.props,a=t.dateStart,r=t.dateFinish,i=n.createColumnsFromDates(a,r,e.data);i=n.addActivitiesToColumns(e.data,i),n.setState({activities:e.data,columns:i})})).catch((function(e){return n.props.error(e)}))},n.putActivityIndexDate=function(e){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}};return F.a.put("".concat(z).concat(n.props.group.id,"/").concat(e.id),{index:e.index,date:e.date},a).catch((function(e){return n.props.error(e)}))},n.addActivityToState=function(e){var t=[].concat(Object(m.a)(n.state.activities),[e]),a=n.state.columns;a=n.addActivitiesToColumns(t,a),n.setState({activities:t,columns:a})},n.removeActivityFromState=function(e){var t=n.state.activities.filter((function(t){return t.id!==e})),a=n.state.columns;for(var r in a){var i=a[r].actIds.indexOf(e);if(i>-1){a[r].actIds.splice(i,1);break}}n.setState({activities:t,columns:a})},n.updateActivityInState=function(e){var t=n.state,a=t.activities,r=t.columns,i=a.findIndex((function(t){return t.id===e.id})),o="default";if(i>-1){o=a[i].date?a[i].date:"default",a[i]=e;var c=e.date?e.date:"default";c!==o&&(i=r[o].actIds.indexOf(e.id),r[o].actIds.splice(i,1),r[c].actIds.push(e.id)),n.setState({activities:a,columns:r})}else console.error("Activity not found.")},n.updateActivityIndexesInState=function(e){var t=Object(m.a)(n.state.activities);e.actIds.forEach((function(a,r){var i=t.findIndex((function(e){return e.id===a}));i>-1&&(t[i].index!==r||t[i].date!==e.id)&&(t[i].index=r,t[i].date="default"!==e.id?e.id:null,n.putActivityIndexDate(t[i]))})),n.setState({activities:t})},n.compareTime=function(e,t){var n=De(e.time),a=De(t.time);return n>a?1:a>n?-1:0},n.sortActivityIndexesByTime=function(e){var t=e.actIds.map((function(e){return n.state.activities.find((function(t){return t.id===e}))}));t.sort(n.compareTime),e.actIds=t.map((function(e){return e.id})),n.updateActivityIndexesInState(e),n.setState({columns:Object(st.a)({},n.state.columns,Object(ct.a)({},e.id,e))})},n.onDragEnd=function(e){var t,a=e.destination,r=e.source,i=e.draggableId;if(a&&(a.droppableId!==r.droppableId||a.index!==r.index)){var o=n.state.columns[r.droppableId],c=n.state.columns[a.droppableId];if(o!==c){var s=Object(m.a)(o.actIds);s.splice(r.index,1);var l=Object(st.a)({},o,{actIds:s});n.updateActivityIndexesInState(l);var u=Object(m.a)(c.actIds);u.splice(a.index,0,i);var p=Object(st.a)({},c,{actIds:u});n.updateActivityIndexesInState(p);var d=Object(st.a)({},n.state,{columns:Object(st.a)({},n.state.columns,(t={},Object(ct.a)(t,l.id,l),Object(ct.a)(t,p.id,p),t))});n.setState(d)}else{var h=Object(m.a)(o.actIds);h.splice(r.index,1),h.splice(a.index,0,i);var f=Object(st.a)({},o,{actIds:h});n.updateActivityIndexesInState(f);var v=Object(st.a)({},n.state,{columns:Object(st.a)({},n.state.columns,Object(ct.a)({},f.id,f))});n.setState(v)}}},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getActivities().then((function(){return e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{marginTop:"10px",marginBottom:"20px"}},r.a.createElement("h1",null,"Attivit\xe0"," ",r.a.createElement(Et,{group:this.props.group,addActivityToState:this.addActivityToState,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish})),this.state.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):r.a.createElement(lt.a,{onDragEnd:this.onDragEnd},r.a.createElement("div",{className:"hs noselect"},this.state.columnOrder.map((function(t){var n=e.state.columns[t],a=n.actIds.map((function(t){return e.state.activities.find((function(e){return e.id===t}))}));return r.a.createElement(gt,{key:n.id,column:n,activities:a,addActivityToState:e.addActivityToState,updateActivityInState:e.updateActivityInState,removeActivityFromState:e.removeActivityFromState,group:e.props.group,dateStart:e.props.dateStart,dateFinish:e.props.dateFinish,sortActivityIndexesByTime:e.sortActivityIndexesByTime})})))))}}]),t}(a.Component),yt=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))}}}))(bt),Ot=(n(306),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).colProps={xs:"12",sm:"12",md:"6",lg:"4",xl:"3"},n.state={showModalDelete:!1},n.showModalDelete=function(){n.setState({showModalDelete:!n.state.showModalDelete})},n.handleDelete=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.delete("".concat("https://holpoint.ns0.it/api/attachmentremove/").concat(n.props.id),t).then((function(e){n.props.removeAttFromState(n.props.id)})).catch((function(e){return n.props.error(e)}))},n.doesCurrentUserOwnThisAttachment=function(){return n.props.currentUser.id===n.props.owner},n.download=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};F()(Object(st.a)({url:"".concat("https://holpoint.ns0.it/api/attachment/").concat(n.props.id)},t,{method:"GET",responseType:"blob"})).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",n.props.name),document.body.appendChild(a),a.click()})).catch((function(e){return n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:"attachment-card"},r.a.createElement("span",{onClick:this.download},r.a.createElement("span",{className:"mr-2"},function(e){var t=/(?:\.([^.]+))?$/.exec(e)[1];return["doc","docx"].indexOf(t)>=0?r.a.createElement(_e.j,null):["xls","xlsx"].indexOf(t)>=0?r.a.createElement(_e.g,null):["ppt","pptx"].indexOf(t)>=0?r.a.createElement(_e.i,null):["jpeg","jpg","png"].indexOf(t)>=0?r.a.createElement(_e.l,null):"pdf"===t?r.a.createElement(_e.h,null):r.a.createElement(_e.f,null)}(this.props.name)),this.props.name),this.doesCurrentUserOwnThisAttachment()&&r.a.createElement(g.a,{className:"ml-2",variant:"plain",onClick:this.showModalDelete},r.a.createElement(_e.s,null))),r.a.createElement(xe,{show:this.state.showModalDelete,onHide:this.showModalDelete,onClick:this.handleDelete}))}}]),t}(a.Component)),St=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))}}}))(Ot),jt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={file:null},n.handleFileChange=function(e){n.setState({file:e.target.files[0]})},n.handleSubmit=function(e){e.preventDefault();var t=n.state.file;if(t){var a=new FormData;a.append("file",t,t.name);var r=localStorage.getItem("token"),i={headers:{"Content-Type":"multipart/form-data",Authorization:"Token ".concat(r)}};return F.a.post("".concat("https://holpoint.ns0.it/api/attachmentupload/").concat(n.props.group.id),a,i).then((function(e){n.props.addAttToState(e.data),n.setState({file:null}),document.getElementById("file").value=""})).catch((function(e){n.props.error(e)}))}},n.renderCards=function(){var e=[];return n.props.group.attachments.forEach((function(t){return e.push(r.a.createElement(St,Object.assign({key:t.id},t,{addAttToState:n.addAttToState,removeAttFromState:n.props.removeAttFromState})))})),r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",margin:"20px"}},e)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,this.renderCards(),r.a.createElement(pe.a,{onSubmit:this.handleSubmit},r.a.createElement(pe.a.Group,{controlId:"file"},r.a.createElement(pe.a.Label,null,"Carica file"),r.a.createElement(pe.a.Control,{type:"file",onChange:this.handleFileChange})),r.a.createElement(g.a,{type:"submit"},"Aggiungi")))}}]),t}(a.Component),Ct=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))}}}))(jt),It=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(it,{title:"Allegati",component:r.a.createElement(Ct,{group:this.props.group,addAttToState:this.props.addAttToState,removeAttFromState:this.props.removeAttFromState})}),this.props.dateStart&&this.props.dateFinish?r.a.createElement(yt,{group:this.props.group,dateStart:this.props.dateStart,dateFinish:this.props.dateFinish}):r.a.createElement("div",{style:{textAlign:"center",color:"#777",fontSize:"20px"}},"\xc8 necessario definire la data di partenza e la data di ritorno per pianificare le attivit\xe0"))}}]),t}(a.Component),kt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r))))._isMounted=!1,n.state={loading:!0,groups:[]},n.addGroup=function(e){n.setState({groups:[].concat(Object(m.a)(n.state.groups),[e])})},n.getGroups=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.get("".concat(_),t).then((function(e){n._isMounted&&n.setState({loading:!1,groups:e.data})})).catch((function(e){n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.getGroups()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){return r.a.createElement(h.a,null,this.props.currentUser.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):r.a.createElement(it,{title:"Gruppi",component:r.a.createElement(ue,this.state),badge:r.a.createElement(Ue,{addGroup:this.addGroup})}))}}]),t}(a.Component),wt=Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))}}}))(kt),At=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).divStyle={marginBottom:"20px"},n.colProps={xs:"12",sm:"12",md:"6",lg:"6",xl:"6"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){rn()&&this.props.history.push("/home")}},{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(le.a,{className:"justify-content-md-center"},r.a.createElement(se.a,null,r.a.createElement("div",{style:this.divStyle},r.a.createElement(te,{fontSize:"110px"})))),r.a.createElement(le.a,null,r.a.createElement(se.a,this.colProps,r.a.createElement("div",{style:this.divStyle},this.props.form())),r.a.createElement(se.a,this.colProps,r.a.createElement("div",{style:this.divStyle},r.a.createElement("h3",{className:"display-4"},"Contatta i tuoi amici e organizza splendide vacanze!")))))}}]),t}(a.Component),Tt=Object(d.o)(At),Ft=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={picture:null},n.handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.username.value,r=t.email.value,i=t.first_name.value,o=t.last_name.value,c=n.state.picture;n.props.putCurrentUser(a,r,i,o,c)},n.handlePictureChange=function(e){n.setState({picture:e.target.files[0]})},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(pe.a,{onSubmit:this.handleSubmit},r.a.createElement(pe.a.Group,{controlId:"username"},r.a.createElement(pe.a.Label,null,"Username"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.currentUser.username})),r.a.createElement(pe.a.Group,{controlId:"email"},r.a.createElement(pe.a.Label,null,"Email"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.currentUser.email})),r.a.createElement(pe.a.Group,{controlId:"first_name"},r.a.createElement(pe.a.Label,null,"Nome"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.currentUser.first_name})),r.a.createElement(pe.a.Group,{controlId:"last_name"},r.a.createElement(pe.a.Label,null,"Cognome"),r.a.createElement(pe.a.Control,{type:"text",defaultValue:this.props.currentUser.last_name})),r.a.createElement(pe.a.Group,{controlId:"picture"},r.a.createElement(pe.a.Label,null,"Immagine profilo"),r.a.createElement(pe.a.Control,{type:"file",accept:"image/png, image/jpeg",onChange:this.handlePictureChange})),r.a.createElement(g.a,{type:"submit"},"Modifica"))}}]),t}(a.Component),Dt=Object($.b)(null,(function(e){return{putCurrentUser:function(t,n,a,r,i){return e(function(e,t,n,a,r){var i=localStorage.getItem("token"),o={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(i)}};return function(c){return c({type:"LOADING"}),F.a.put("https://holpoint.ns0.it/api/current_user",{username:e,email:t,first_name:n,last_name:a},o).then((function(s){if(c({type:"PUT_CURRENT_USER",username:e,email:t,first_name:n,last_name:a}),r){var l=new FormData;return l.append("picture",r,r.name),o={headers:{"Content-Type":"multipart/form-data",Authorization:"Token ".concat(i)}},F.a.put("".concat("https://holpoint.ns0.it/api/pictureupload"),l,o).then((function(e){c({type:"PICTURE_UPDATE",data:e.data}),c({type:"DONE"}),c(q("Informazioni aggiornate con successo!","success"))})).catch((function(e){c({type:"DONE"}),c(P(e))}))}c({type:"DONE"})})).catch((function(e){c({type:"DONE"}),c(P(e))}))}}(t,n,a,r,i))}}}))(Ft),Rt=n(413),Ut=n(405),_t=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={loading:!0,receivedRequests:[]},n.updateRrInState=function(){n.props.friendRequests.receivedRequests&&n.setState({receivedRequests:n.props.friendRequests.receivedRequests})},n.updateList=function(){n.setState({loading:!0}),n.props.loadRequests().then(n.setState({loading:!1}))},n.listRequests=function(){var e=n.props.friendRequests.receivedRequests,t=[];return 0!==e.length?(e.forEach((function(e){return t.push(r.a.createElement(Bt,Object.assign({key:e.id},e)))})),r.a.createElement("table",{style:{tableLayout:"fixed",width:"100%"}},r.a.createElement("tbody",null,t))):r.a.createElement("div",{style:{textAlign:"center"}},"Non ci sono richieste")},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.updateRrInState()}},{key:"componentDidUpdate",value:function(e,t){e.friendRequests!==this.props.friendRequests&&(this.setState({loading:this.props.friendRequests.loading}),this.updateRrInState())}},{key:"render",value:function(){var e=r.a.createElement(Rt.a,null,r.a.createElement(Rt.a.Title,{as:"h3"},"Richieste di amicizia"," ",this.state.loading?r.a.createElement(Ut.a,{className:"float-right",size:"sm",animation:"border"}):r.a.createElement("div",{className:"float-right ml-3",onClick:this.updateList},r.a.createElement(_e.o,{style:{marginTop:"-10px"}}))),r.a.createElement(Rt.a.Content,null,this.listRequests()));return r.a.createElement(O.a,{trigger:"click",placement:"bottom",overlay:e},r.a.createElement(g.a,{variant:"plain",className:"ml-2 mr-2"},r.a.createElement(_e.w,null),0!==this.props.friendRequests.receivedRequests.length&&r.a.createElement(_e.d,{className:"mb-2",size:"0.6em",color:"var(--danger)"})))}}]),t}(a.Component),xt=Object($.b)((function(e){return{friendRequests:e.friendRequest}}),(function(e){return{loadRequests:function(){return e(V())}}}))(_t);function Nt(e){return r.a.createElement(g.a,{variant:"danger",onClick:e.onClick},r.a.createElement(_e.x,null)," Rimuovi")}var Mt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={sent:!1,received:!1,requestId:null,friend:!1},n.checkSentReceived=function(){if(!n.props.friendRequests.loading){var e=n.props.friendRequests,t=n.props.profile,a=(!1).sent,r=(!1).received,i=null;e.sentRequests&&((a=e.sentRequests.find((function(e){return e.receiver.id===t.id})))&&(i=a.id),a=Boolean(a)),e.receivedRequests&&((r=e.receivedRequests.find((function(e){return e.sender.id===t.id})))&&(i=r.id),r=Boolean(r)),n.setState({sent:a,received:r,requestId:i})}},n.isAlreadyFriend=function(){var e=null;if(!n.props.currentUser.loading){var t=n.props.currentUser.profile.friends;t&&(e=t.find((function(e){return e.id===n.props.profile.id}))),n.setState({friend:Boolean(e)})}},n.sendFriendRequest=function(){var e=n.props.currentUser.id,t=n.props.profile.id;n.props.sendRequest(e,t).then(n.setState({sent:!0,received:!1}))},n.acceptOrRefuseFriendRequest=function(e){if(["Acc","Ref"].includes(e)){var t=n.props.profile.id,a=n.props.currentUser.id,r=n.state.requestId;n.props.respondRequest(r,t,a,e).then((function(){"Acc"===e&&n.props.addFriendToStore(n.props.profile),n.setState({sent:!1,received:!1,requestId:null,friend:"Acc"===e})}))}},n.unfriend=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.delete("".concat(L).concat(n.props.profile.id),t).catch((function(e){return n.props.error(e)}))},n.removeFriend=function(){n.unfriend().then((function(){n.props.removeFriendFromStore(n.props.profile),n.setState({friend:!1})}))},n.renderFriendButton=function(){return r.a.createElement(a.Fragment,null,n.state.sent&&r.a.createElement(qt,null),n.state.received&&r.a.createElement(zt,{compact:!1,onClick:n.acceptOrRefuseFriendRequest}),!n.state.sent&&!n.state.received&&r.a.createElement(Gt,{onClick:n.sendFriendRequest}))},n.renderUnfriendButton=function(){return r.a.createElement(Nt,{onClick:n.removeFriend})},n.renderButtons=function(){if(rn()&&n.props.profile.id!==n.props.currentUser.id)return r.a.createElement("span",null,n.state.friend?n.renderUnfriendButton():n.renderFriendButton())},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.checkSentReceived(),this.isAlreadyFriend()}},{key:"componentDidUpdate",value:function(e,t){e.friendRequests.loading===this.props.friendRequests.loading&&e.currentUser.loading===this.props.currentUser.loading||(this.checkSentReceived(),this.isAlreadyFriend())}},{key:"render",value:function(){return r.a.createElement("span",null,!this.props.friendRequests.loading&&this.renderButtons())}}]),t}(a.Component),Lt=Object($.b)((function(e){return{friendRequests:e.friendRequest}}),(function(e){return{error:function(t){return e(P(t))},sendRequest:function(t,n){return e(function(e,t){var n=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(n)}};return function(n){return F.a.post("https://holpoint.ns0.it/api/friendrequest/",{sender:e,receiver:t,status:"Pen"},a).then((function(e){n({type:"POST_FRIEND_REQUEST",payload:e.data})})).catch((function(e){n(P(e))}))}}(t,n))},respondRequest:function(t,n,a,r){return e(Q(t,n,a,r))},addFriendToStore:function(t){return e(H(t))},removeFriendFromStore:function(t){return e(function(e){return{type:"REMOVE_FRIEND_FROM_STORE",friend:e}}(t))}}}))(Mt);function zt(e){return r.a.createElement(E.a,null,r.a.createElement(g.a,{variant:"success",onClick:function(){return e.onClick("Acc")},size:e.size},r.a.createElement(_e.c,null),!e.compact&&" Accetta"),r.a.createElement(g.a,{variant:"warning",onClick:function(){return e.onClick("Ref")},size:e.size},r.a.createElement(_e.s,null),!e.compact&&" Rifiuta"))}function Gt(e){return r.a.createElement(g.a,{variant:"primary",onClick:e.onClick},r.a.createElement(_e.y,null)," Aggiungi")}function qt(){return r.a.createElement(g.a,{variant:"info",disabled:!0},r.a.createElement(_e.v,null)," Attesa")}var Pt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).acceptOrRefuseFriendRequest=function(e){if(["Acc","Ref"].includes(e)){var t=n.props.sender.id,a=n.props.receiver.id,r=n.props.id;n.props.respondRequest(r,t,a,e).then((function(){"Acc"===e&&n.props.addFriendToStore(n.props.sender)}))}},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(a.Fragment,null,r.a.createElement("tr",{style:{height:"50px"}},r.a.createElement("td",{onClick:function(){return e.props.history.push("/profile/".concat(e.props.sender.username))}},r.a.createElement("div",{style:{fontWeight:"bold"}},this.props.sender.username)," ",this.props.sender.first_name," ",this.props.sender.last_name),r.a.createElement("td",{style:{textAlign:"right"}},r.a.createElement(zt,{compact:!0,size:"sm",onClick:this.acceptOrRefuseFriendRequest}))))}}]),t}(a.Component),Bt=Object(d.o)(Object($.b)(null,(function(e){return{respondRequest:function(t,n,a,r){return e(Q(t,n,a,r))},addFriendToStore:function(t){return e(H(t))}}}))(Pt)),Ht=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).imageSize=200,n.rowStyle={marginTop:"20px"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(k.a,{src:this.props.profile.profile.picture?this.props.profile.profile.picture:A.a,className:"profile-pic-big"}),r.a.createElement("h1",{className:"display-4"},this.props.profile.first_name," ",this.props.profile.last_name),r.a.createElement(Lt,this.props)))}}]),t}(a.Component),Vt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,profile:{}},n.addIdeaToState=function(e){return new Promise((function(t){var a=Object(st.a)({},n.state.profile);a.profile.ideas=[].concat(Object(m.a)(a.profile.ideas),[e]),n.setState({profile:a}),t()}))},n.updateIdeaInState=function(e){return new Promise((function(t){var a=Object(st.a)({},n.state.profile),r=Object(m.a)(n.state.profile.profile.ideas),i=r.findIndex((function(t){return t.id==e.id}));i>-1&&(r[i]=e,a.profile.ideas=r,n.setState({profile:a})),t()}))},n.deleteIdea=function(e){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}};return F.a.delete("".concat(N).concat(e,"/"),a).then((function(t){n.removeIdeaFromState(e),n.props.removeIdeaFromStore(e)})).catch((function(e){n.props.error(e)}))},n.removeIdeaFromState=function(e){var t=Object(st.a)({},n.state.profile);t.profile.ideas=t.profile.ideas.filter((function(t){return t.id!==e})),n.setState({profile:t})},n.getProfile=function(){n.setState({loading:!0});var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.get("".concat(U).concat(n.props.match.params.username),t).then((function(e){n.setState({loading:!1,profile:e.data})})).catch((function(e){n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getProfile()}},{key:"componentDidUpdate",value:function(e,t){e.match.params.username!==this.props.match.params.username&&this.getProfile()}},{key:"render",value:function(){return r.a.createElement(h.a,null,this.state.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):r.a.createElement(a.Fragment,null,r.a.createElement(le.a,null,r.a.createElement(se.a,{xs:12,sm:12,md:4,lg:4,xl:4},r.a.createElement(it,{title:this.state.profile.username,component:r.a.createElement(Ht,{profile:this.state.profile,currentUser:this.props.currentUser})}),r.a.createElement(it,{title:"Amici",badge:r.a.createElement(j.a,{pill:!0,variant:"primary"},this.state.profile.profile.friends.length),component:r.a.createElement(he,{friends:this.state.profile.profile.friends})})),r.a.createElement(se.a,{xs:12,sm:12,md:8,lg:8,xl:8},r.a.createElement(it,{title:"Idee",component:r.a.createElement(Le,{ideas:this.state.profile.profile.ideas,deleteIdea:this.deleteIdea,updateIdeaInState:this.updateIdeaInState}),badge:r.a.createElement(a.Fragment,null,this.props.currentUser.username===this.props.match.params.username&&r.a.createElement(qe,{addIdeaToState:this.addIdeaToState}))})))))}}]),t}(a.Component),Qt=Object(d.o)(Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{removeIdeaFromStore:function(t){return e(function(e){return{type:"REMOVE_IDEA_FROM_STORE",ideaId:e}}(t))},error:function(t){return e(P(t))}}}))(Vt)),Wt=n(409),Yt=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,group:{},selectedFriends:[],dateStart:null,dateFinish:null,phase:0},n.setDateStart=function(e){return n.setState({dateStart:e})},n.setDateFinish=function(e){return n.setState({dateFinish:e})},n.getGroup=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}},a=n.props.match.params.id;return F.a.get("".concat(_).concat(a,"/"),t).then((function(e){var t=[];e.data.profiles.forEach((function(e){return t.push(e.id)})),n.setState({loading:!1,group:e.data,selectedFriends:t,dateStart:Ie(e.data.date_start),dateFinish:Ie(e.data.date_finish)})})).catch((function(e){n.props.error(e)}))},n.isCurrentUserAPartecipant=function(e){if(e.profiles)return Boolean(e.profiles.find((function(e){return e.id===n.props.currentUser.id})))},n.putGroup=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,c=localStorage.getItem("token"),s={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(c)}},l={name:e,description:t,profiles:a,ideas:r,date_start:i,date_finish:o};return F.a.put("".concat(_).concat(n.state.group.id,"/"),l,s).then((function(e){n.setState({group:e.data}),n.isCurrentUserAPartecipant(e.data)||(n.props.addAlert("Non fai pi\xf9 parte del gruppo ".concat(n.props.name,"."),"warning"),n.props.history.push("/home"))})).catch((function(e){return n.props.error(e),e}))},n.deleteGroup=function(){var e=localStorage.getItem("token"),t={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}};return F.a.delete("".concat(x).concat(n.state.group.id,"/"),t).then((function(e){n.props.history.push("/home")})).catch((function(e){n.props.error(e)}))},n.deselectFriend=function(e){var t=Object(m.a)(n.state.selectedFriends),a=t.indexOf(e);-1!==a&&(t.splice(a,1),n.setState({selectedFriends:t}))},n.selectFriend=function(e){n.state.selectedFriends.includes(e)?n.deselectFriend(e):n.setState({selectedFriends:[].concat(Object(m.a)(n.state.selectedFriends),[e])})},n.getCleanDataForPutGroup=function(){var e=Object(st.a)({},n.state.group);return e.profiles&&(e.profiles=e.profiles.map((function(e){return e.id}))),e.ideas&&(e.ideas=e.ideas.map((function(e){return e.id}))),e},n.removeIdeaFromGroup=function(e){var t=n.getCleanDataForPutGroup();t.ideas=t.ideas.filter((function(t){return t!==e}));var a=t.name,r=t.description,i=t.profiles,o=t.ideas;return n.putGroup(a,r,i,o)},n.updateIdeaInState=function(e){return new Promise((function(t){var a=n.state.group,r=Object(m.a)(n.state.group.ideas),i=r.findIndex((function(t){return t.id===e.id}));i>-1&&(r[i]=e,a.ideas=r,n.setState({group:a})),t()}))},n.addIdeaToState=function(e){var t=n.state.group;t.ideas.push(e),n.setState({group:t});var a=n.getCleanDataForPutGroup(),r=a.name,i=a.description,o=a.profiles,c=a.ideas;return n.putGroup(r,i,o,c)},n.addIdeaIdsListForPutGroup=function(e){if(0!==e.length){var t=n.getCleanDataForPutGroup();t.ideas=[].concat(Object(m.a)(t.ideas),Object(m.a)(e));var a=t.name,r=t.description,i=t.profiles,o=t.ideas;return n.putGroup(a,r,i,o)}},n.removeAttFromState=function(e){var t=n.state.group.attachments.filter((function(t){return t.id!==e}));n.setState({group:Object(st.a)({},n.state.group,{attachments:t})})},n.addAttToState=function(e){var t=[].concat(Object(m.a)(n.state.group.attachments),[e]);n.setState({group:Object(st.a)({},n.state.group,{attachments:t})})},n.putFavIdea=function(e){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}},r={prefered_idea:e};return F.a.put("".concat(x).concat(n.state.group.id,"/"),r,a).then((function(e){var t=n.state.group;t.prefered_idea=e.data.prefered_idea,n.setState({group:t})})).catch((function(e){n.props.error(e)}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.getGroup().then((function(){var t=e.state,n=t.dateStart,a=t.dateFinish;e.state.group.prefered_idea&&n&&a&&e.setState({phase:1})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,null,this.state.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):r.a.createElement(a.Fragment,null,r.a.createElement(Wt.a,{style:{marginTop:"10px"},justify:!0,variant:"tabs"},r.a.createElement(Wt.a.Item,null,r.a.createElement(Wt.a.Link,{onClick:function(){return e.setState({phase:0})}},"Ideazione")),r.a.createElement(Wt.a.Item,null,r.a.createElement(Wt.a.Link,{onClick:function(){return e.setState({phase:1})}},"Pianificazione"))),0===this.state.phase?r.a.createElement(ot,{group:this.state.group,selectFriend:this.selectFriend,selectedFriends:this.state.selectedFriends,putGroup:this.putGroup,deleteGroup:this.deleteGroup,dateStart:this.state.dateStart,dateFinish:this.state.dateFinish,setDateStart:this.setDateStart,setDateFinish:this.setDateFinish,removeIdeaFromGroup:this.removeIdeaFromGroup,updateIdeaInState:this.updateIdeaInState,addIdeaToState:this.addIdeaToState,addIdeaIdsListForPutGroup:this.addIdeaIdsListForPutGroup,putFavIdea:this.putFavIdea}):r.a.createElement(It,{addAttToState:this.addAttToState,removeAttFromState:this.removeAttFromState,group:this.state.group,dateStart:this.state.dateStart,dateFinish:this.state.dateFinish})))}}]),t}(a.Component),Jt=Object(d.o)(Object($.b)((function(e){return{currentUser:e.currentUser}}),(function(e){return{error:function(t){return e(P(t))},addAlert:function(t,n){return e(q(t,n))}}}))(Yt)),Kt=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(h.a,null,this.props.currentUser.loading?r.a.createElement(f.a,{striped:!0,variant:"success",now:100,animated:!0}):r.a.createElement(it,{title:"Impostazioni utente",component:r.a.createElement(Dt,{currentUser:this.props.currentUser})})))}}]),t}(a.Component),Xt=Object($.b)((function(e){return{currentUser:e.currentUser}}))(Kt),$t=function(e){return r.a.createElement(v.a,{style:{backgroundColor:"var(--holpoint-yellow)"},className:"card-login"},e.children)},Zt=(n(307),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.username.value,r=t.password.value;n.props.onAuth(a,r).then((function(e){e||(n.props.history.push("/home"),n.props.removeAllAlerts())}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement($t,null,r.a.createElement(v.a.Header,null,r.a.createElement("h1",{className:"display-4"},"Log In")),r.a.createElement(pe.a,{onSubmit:this.handleSubmit},r.a.createElement(v.a.Body,null,r.a.createElement(pe.a.Group,{controlId:"username"},r.a.createElement(pe.a.Label,null,"Username"),r.a.createElement(pe.a.Control,{type:"text",placeholder:"user_name"}),r.a.createElement(pe.a.Control.Feedback,null,"ciao")),r.a.createElement(pe.a.Group,{controlId:"password"},r.a.createElement(pe.a.Label,null,"Password"),r.a.createElement(pe.a.Control,{type:"password",placeholder:"mysecretpassword"}))),r.a.createElement(v.a.Footer,null,this.props.loading?r.a.createElement(g.a,{variant:"primary",disabled:!0},r.a.createElement(Ut.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"})," Accesso"):r.a.createElement(g.a,{type:"submit"},"Accedi"),r.a.createElement("span",{className:"forgot-password ml-2"},r.a.createElement("a",{href:"https://holpoint.ns0.it/reset-password/"},"Password dimenticata?")))))}}]),t}(a.Component)),en=Object(d.o)(Object($.b)((function(e){return{loading:e.auth.loading,error:e.auth.error}}),(function(e){return{onAuth:function(t,n){return e(function(e,t){return function(n){return n({type:"AUTH_START"}),F.a.post("https://holpoint.ns0.it/rest-auth/login/",{username:e,password:t},K).then((function(e){var t=e.data.key,a=new Date;a.setFullYear(a.getFullYear()+1),localStorage.setItem("token",t),localStorage.setItem("expirationDate",a),n(W(t)),n(B()),n(V()),n(J(3600))})).catch((function(e){return n(Y(e)),n(P(e)),e}))}}(t,n))},removeAllAlerts:function(){return e({type:"REMOVE_ALL_ALERTS"})}}}))(Zt)),tn=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t=e.currentTarget,a=t.username.value,r=t.email.value,i=t.password1.value,o=t.password2.value;n.props.onAuth(a,r,i,o).then((function(e){e||(n.props.history.push("/home"),n.props.removeAllAlerts())}))},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement($t,null,r.a.createElement(v.a.Header,null,r.a.createElement("h1",{className:"display-4"},"Sign Up")),r.a.createElement(pe.a,{onSubmit:this.handleSubmit},r.a.createElement(v.a.Body,null,r.a.createElement(pe.a.Group,{controlId:"username"},r.a.createElement(pe.a.Label,null,"Username"),r.a.createElement(pe.a.Control,{type:"text",placeholder:"user_name"})),r.a.createElement(pe.a.Group,{controlId:"email"},r.a.createElement(pe.a.Label,null,"Email"),r.a.createElement(pe.a.Control,{type:"text",placeholder:"email@email.com"})),r.a.createElement(pe.a.Row,null,r.a.createElement(pe.a.Group,{controlId:"password1",as:se.a,xs:12,sm:12,md:12,lg:6},r.a.createElement(pe.a.Label,null,"Password"),r.a.createElement(pe.a.Control,{type:"password",placeholder:"mysecretpassword"})),r.a.createElement(pe.a.Group,{controlId:"password2",as:se.a,xs:12,sm:12,md:12,lg:6},r.a.createElement(pe.a.Label,null,"Conferma"),r.a.createElement(pe.a.Control,{type:"password",placeholder:"mysecretpassword"})))),r.a.createElement(v.a.Footer,null,this.props.loading?r.a.createElement(g.a,{variant:"primary",disabled:!0},r.a.createElement(Ut.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"})," Registrazione"):r.a.createElement(g.a,{type:"submit"},"Registrati"))))}}]),t}(a.Component),nn=Object(d.o)(Object($.b)((function(e){return{loading:e.auth.loading,error:e.auth.error}}),(function(e){return{onAuth:function(t,n,a,r){return e(function(e,t,n,a){return function(r){return r({type:"AUTH_START"}),F.a.post("https://holpoint.ns0.it/rest-auth/registration/",{username:e,email:t,password1:n,password2:a},K).then((function(e){var t=e.data.key,n=new Date;n.setFullYear(n.getFullYear()+1),localStorage.setItem("token",t),localStorage.setItem("expirationDate",n),r(W(t)),r(B()),r(V()),r(J(3600))})).catch((function(e){return r(Y(e)),r(P(e)),e}))}}(t,n,a,r))},removeAllAlerts:function(){return e({type:"REMOVE_ALL_ALERTS"})}}}))(tn)),an=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).style={fontFamily:"'Rancho', cursive",textAlign:"center",marginTop:"60px",marginBottom:"-20px"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:this.style},r.a.createElement("div",{style:{fontSize:"100px",color:"var(--holpoint-blue)"}},"404"),r.a.createElement("div",{style:{fontSize:"50px",color:"var(--holpoint-red)"}},"not found :("))}}]),t}(a.Component),rn=function(){return void 0!==localStorage.getItem("token")&&!(new Date(localStorage.getItem("expirationDate"))<=new Date)},on=function(e){return r.a.createElement("div",null,r.a.createElement(d.g,null,r.a.createElement(d.d,{exact:!0,path:"/"},r.a.createElement(Tt,{form:function(){return r.a.createElement(en,null)}})),r.a.createElement(d.d,{exact:!0,path:"/login"},r.a.createElement(Tt,{form:function(){return r.a.createElement(en,null)}})),r.a.createElement(d.d,{exact:!0,path:"/register"},r.a.createElement(Tt,{form:function(){return r.a.createElement(nn,null)}})),r.a.createElement(d.d,{exact:!0,path:"/home",component:wt}),r.a.createElement(d.d,{exact:!0,path:"/profile/:username",component:Qt}),r.a.createElement(d.d,{exact:!0,path:"/group/:id",component:Jt}),r.a.createElement(d.d,{exact:!0,path:"/settings",component:Xt}),r.a.createElement(d.d,{path:"*",component:an})))},cn=n(411),sn=n(213),ln=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).doSearch=function(e){n.setState({loading:!0}),n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout((function(){n.getUsers()}),300)},n.isEmptyOrSpaces=function(e){return null===e||null!==e.match(/^ *$/)},n.getUsers=function(){var e=document.getElementById("search-text-field").value;if(!n.isEmptyOrSpaces(e)){var t=localStorage.getItem("token"),a={headers:{"Content-Type":"application/json",Authorization:"Token ".concat(t)}};return F.a.get("".concat("https://holpoint.ns0.it/api/search/user/").concat(e),a).then((function(e){return n.setState({results:e.data,loading:!1})})).catch((function(e){n.props.error(e)}))}n.setState({loading:!1})},n.renderResults=function(){var e=[],t=n.state.results;return t&&t.forEach((function(t){return e.push(r.a.createElement(pn,Object.assign({key:t.id},t)))})),e},n.state={results:[],loading:!1},n.timeout=0,n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=r.a.createElement(Rt.a,{style:{minWidth:"200px"}},r.a.createElement(Rt.a.Title,{as:"h3"},"Risultati ",this.state.loading&&r.a.createElement(Ut.a,{className:"float-right",size:"sm",animation:"border"})),0!==this.state.results.length&&r.a.createElement(Rt.a.Content,null,r.a.createElement("div",null,this.renderResults())));return r.a.createElement(pe.a,{inline:!0,autoComplete:"off"},r.a.createElement(O.a,{trigger:"focus",placement:"bottom",overlay:e},r.a.createElement(sn.a,{id:"search-text-field",type:"text",placeholder:"Cerca username",className:"mr-sm-2",onChange:this.doSearch})))}}]),t}(a.Component),un=Object($.b)(null,(function(e){return{error:function(t){return e(P(t))}}}))(ln),pn=Object(d.o)((function(e){return r.a.createElement("div",{onClick:function(){return e.history.push("/profile/".concat(e.username))}},r.a.createElement("div",null,r.a.createElement("span",{style:{fontWeight:"bold"}},e.username)," ",e.first_name," ",e.last_name))})),dn=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).navbarStyle={backgroundColor:"var(--holpoint-yellow)"},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){rn()||this.props.history.push("/login")}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(cn.a,{style:this.navbarStyle,expand:"lg"},r.a.createElement(cn.a.Brand,{to:"/"},r.a.createElement(b.LinkContainer,{to:"/"},r.a.createElement(cn.a.Brand,null,r.a.createElement(te,{fontSize:"30px"})))),r.a.createElement(cn.a.Toggle,null),r.a.createElement(cn.a.Collapse,{className:"justify-content-end"},r.a.createElement(Wt.a,null,this.props.isAuthenticated?r.a.createElement(a.Fragment,null,r.a.createElement(b.LinkContainer,{to:"/home"},r.a.createElement(Wt.a.Link,{className:"mr-sm-2"},"Home")),r.a.createElement(Wt.a.Item,null,r.a.createElement(xt,null)),r.a.createElement(Wt.a.Item,null,r.a.createElement(un,null)),r.a.createElement(Wt.a.Item,null,r.a.createElement(ee,null))):r.a.createElement(y,null)))),r.a.createElement(Oe,{alerts:this.props.alerts},r.a.createElement(ye,null)),this.props.children)}}]),t}(a.Component),mn=Object(d.o)(dn),hn=n(36),fn=Object(hn.a)(),vn=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup()}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement(d.e,{history:fn},r.a.createElement(mn,this.props,r.a.createElement(on,null))))}}]),t}(a.Component),En=Object($.b)((function(e){return{isAuthenticated:null!==e.auth.token,username:e.currentUser.username,alerts:e.alerts}}),(function(e){return{onTryAutoSignup:function(){return e((function(e){var t=localStorage.getItem("token");if(void 0===t)X();else{var n=new Date(localStorage.getItem("expirationDate"));n<=new Date?X():(e(W(t)),e(B()),e(V()),e(J((n.getTime()-(new Date).getTime())/1e3)))}}))}}}))(vn),gn=n(35),bn=function(e,t){return Object(st.a)({},e,{},t)},yn={token:null,error:null,loading:!1},On=function(e,t){return bn(e,{error:null,loading:!0})},Sn=function(e,t){return bn(e,{token:t.token,error:null,loading:!1})},jn=function(e,t){return bn(e,{error:t.error,loading:!1})},Cn=function(e,t){return bn(e,{token:null})},In=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return On(e);case"AUTH_SUCCESS":return Sn(e,t);case"AUTH_FAIL":return jn(e,t);case"AUTH_LOGOUT":return Cn(e);default:return e}},kn=n(214),wn=n.n(kn),An=[],Tn=function(e,t){return window.scrollTo(0,0),[].concat(Object(m.a)(e),[{text:t.text,style:t.style,id:wn()()}])},Fn=function(e,t){return e.filter((function(e){return e.id!==t.id}))},Dn=function(e,t){return An},Rn=function(e,t){Tn(e,t)},Un=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ALERT":return Tn(e,t);case"REMOVE_ALERT":return Fn(e,t);case"REMOVE_ALL_ALERTS":return Dn();case"ERROR":return Rn(e,t);default:return e}},_n={id:"",username:"",first_name:"",last_name:"",email:"",profile:{},error:null,loading:!0},xn=function(e,t){return bn(e,{error:null,loading:!0})},Nn=function(e,t){var n=t.id,a=t.username,r=t.first_name,i=t.last_name,o=t.email,c=t.profile;return bn(e,{error:null,loading:!1,id:n,username:a,first_name:r,last_name:i,email:o,profile:c})},Mn=function(e,t){return bn(e,{error:t.error,loading:!1})},Ln=function(e,t){return bn(e,_n)},zn=function(e,t){var n=t.username,a=t.email,r=t.first_name,i=t.last_name;return bn(e,{username:n,email:a,first_name:r,last_name:i})},Gn=function(e,t){return bn(e,{loading:!0})},qn=function(e,t){return bn(e,{loading:!1})},Pn=function(e,t){var n=t.friend,a=Object(st.a)({},e.profile);return a.friends.push(n),bn(e,{profile:a})},Bn=function(e,t){var n=t.friend,a=Object(st.a)({},e.profile);return a.friends=a.friends.filter((function(e){return e.id!==n.id})),a.friends||(a.friends=[]),bn(e,{profile:a})},Hn=function(e,t){var n=Object(st.a)({},e.profile);return n.picture="".concat(D).concat(t.data.picture),bn(e,{profile:n})},Vn=function(e,t){var n=e.profile.ideas;return n.push(t.idea),Object(st.a)({},e,{profile:Object(st.a)({},e.profile,{ideas:n})})},Qn=function(e,t){var n=e.profile.ideas;return n=n.filter((function(e){return e.id!==t.ideaId})),Object(st.a)({},e,{profile:Object(st.a)({},e.profile,{ideas:n||[]})})},Wn=function(e,t){var n=e.profile.ideas,a=t.idea,r=n.findIndex((function(e){return e.id===a.id}));return r>-1?(n[r]=a,Object(st.a)({},e,{profile:Object(st.a)({},e.profile,{ideas:n})})):e},Yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_n,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_CURRENT_USER_START":return xn(e);case"GET_CURRENT_USER_SUCCESS":return Nn(e,t);case"GET_CURRENT_USER_FAIL":return Mn(e,t);case"GET_CURRENT_USER_LOGOUT":return Ln(e);case"PUT_CURRENT_USER":return zn(e,t);case"LOADING":return Gn(e);case"DONE":return qn(e);case"ADD_FRIEND_TO_STORE":return Pn(e,t);case"REMOVE_FRIEND_FROM_STORE":return Bn(e,t);case"PICTURE_UPDATE":return Hn(e,t);case"ADD_IDEA_TO_STORE":return Vn(e,t);case"REMOVE_IDEA_FROM_STORE":return Qn(e,t);case"UPDATE_IDEA_IN_STORE":return Wn(e,t);default:return e}},Jn={sentRequests:[],receivedRequests:[],loading:!0},Kn=function(e,t){var n=t.payload,a=n.sent_requests,r=n.received_requests;return bn(e,{sentRequests:a,receivedRequests:r,loading:!1})},Xn=function(e,t){return bn(e,{sentRequests:[].concat(Object(m.a)(e.sentRequests),[t.payload])})},$n=function(e,t){var n=t.requestId,a=e.receivedRequests.filter((function(e){return e.id!==n}));return a||(a=[]),bn(e,{receivedRequests:a})},Zn=function(e,t){return Jn},ea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_FRIEND_REQUESTS":return Kn(e,t);case"POST_FRIEND_REQUEST":return Xn(e,t);case"PUT_FRIEND_REQUEST":return $n(e,t);case"CLEAR_FRIEND_REQUESTS":return Zn();default:return e}},ta=Object(gn.c)({auth:In,alerts:Un,currentUser:Yn,friendRequest:ea}),na=n(215),aa=(n(390),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||gn.d),ra=Object(gn.e)(ta,{},aa(Object(gn.a)(na.a))),ia=r.a.createElement($.a,{store:ra},r.a.createElement(En,null));o.a.render(ia,document.getElementById("root"))},78:function(e,t,n){e.exports=n.p+"static/media/logo.0863de1f.png"}},[[217,1,2]]]);
//# sourceMappingURL=main.51e2b476.chunk.js.map